{% extends 'base.html.twig' %}

{% block title %}CCM - Dashboard{% endblock %}

{% block css %}
    {{ parent() }}
    <!-- Bootstrap Core CSS -->
{% endblock %}

{% block sidebar %}

    <li>
        <a href="{{ path('dashboard') }}"><i class="fa fa-dashboard fa-fw"></i> Inicio</a>
    </li>
    <li>
        <a href="#"><i class="fa fa-bar-chart-o fa-fw"></i> Informe anual<span class="fa arrow"></span></a>
        <ul class="nav nav-second-level">
            <li>
                <a href="{{ path('investigacion_index') }}">Investigación</a>
            </li>
            <li>
                <a href="{{ path('estudiantes_index') }}">Estudiantes</a>
            </li>
            <li>
                <a href="{{ path('cursos_index') }}">Cursos y seminarios</a>
            </li>
            <li>
                <a href="{{ path('proyectos_index') }}">Proyectos</a>
            </li>
            <li>
                <a href="{{ path('eventos_index') }}">Eventos</a>
            </li>
            <li>
                <a href="{{ path('salidas_index') }}">Licencias y comisiones</a>
            </li>
        </ul>
        <!-- /.nav-second-level -->
    </li>

    <li>
        <a href="{{ path('dashboard')}} "> <i class="fa fa-table fa-fw"></i> Plan de trabajo </a>
    </li>

{% endblock %}

{% block wrapper %}


    <div class="row">
        <div class="col-lg-12">
            <p></p>
            <br>
            {#                <h1 class="page-header">Solicitudes </h1>#}
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6 col-md-6">

            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingOne">
                        <h4 class="panel-title">
                            <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                <i class="fa fa-clock-o" aria-hidden="true"></i> Informe anual
                            </a>
                        </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                        <div class="panel-body">
                            <div class="row">

                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-bar-chart fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('investigacion_index',{'investigaciones':investigaciones} ) }} ">Investigación <span class="counter">{{ investigaciones|length }}</span></a></dd>
                                    </dl>
                                </div>

                                <div class="col-lg-4 col-md-4 text-center">
                                    {% set estpos = estudiantes|length + posdocs|length %}
                                    <dl>
                                        <dt><i class="fa fa-graduation-cap fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('estudiantes_index',{'estudiantes':estudiantes , 'posdocs':posdocs} ) }} ">Estudiantes y Posdocs <span class="counter">{{ estpos }}</span></a></dd>
                                    </dl>
                                </div>

                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-university fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('cursos_index',{'cursos':cursos} ) }} ">Cursos y seminarios <span class="counter">{{ cursos|length }}</span></a></dd>
                                    </dl>
                                </div>

                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-tasks fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('proyectos_index',{'proyectos':proyectos} ) }} ">Proyectos <span class="counter">{{ proyectos|length }}</span></a></dd>
                                    </dl>
                                </div>

                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-calendar fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('eventos_index',{'eventos':eventos} ) }} ">Eventos académicos y de divulgación <span class="counter">{{ eventos|length }}</span></a></dd>
                                    </dl>
                                </div>
                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-globe fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('salidas_index',{'salidas':salidas} ) }} ">Licencias y Comisiones <span class="counter">{{ salidas|length }}</span></a></dd>
                                    </dl>
                                </div>

                             </div>

                             <div class="row">
                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-print fa-3x" aria-hidden="true"></i></dt>
                                        <dd> <button type="button" class="btn btn-link" data-toggle="modal" data-target="#myModal">Vista previa</button> </dd>
                                    </dl>
                                </div>
                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-file-pdf-o fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('informe_pdf') }} "> <h5>Descargar</h5></a></dd>
                                    </dl>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwo">
                        <h4 class="panel-title">
                            <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                <i class="fa fa-calendar-o" aria-hidden="true"></i> Plan de trabajo
                            </a>
                        </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingTwo">
                        <div class="panel-body">
                            <div class="row">
                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        {% if planes|length == 0 %}
                                            <dt><i class="fa fa-plus fa-3x" aria-hidden="true"></i></dt>
                                            <dd><a href="{{ path('plan_new')}} "> <h5>Nuevo plan de trabajo </h5></a></dd>
                                        {% else %}
                                            {% set planid = "" %}

                                            {% for plan in planes %}
                                                <dt><i class="fa fa-edit fa-3x" aria-hidden="true"></i></dt>
                                                <dd><a href="{{ path('plan_edit', {'id': plan.id} )}} "> <h5>Plan de trabajo </h5></a></dd>
                                                {% set planid = plan.id %}

                                            {% endfor %}

                                        {% endif %}

                                    </dl>
                                </div>

                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-print fa-3x" aria-hidden="true"></i></dt>
                                        <dd> <button type="button" class="btn btn-link" data-toggle="modal" data-target="#myModal3">Vista previa</button> </dd>
                                    </dl>
                                </div>
                                <div class="col-lg-4 col-md-4 text-center">
                                    <dl>
                                        <dt><i class="fa fa-file-pdf-o fa-3x" aria-hidden="true"></i></dt>
                                        <dd><a href="{{ path('plan_pdf') }} "> <h5>Descargar</h5></a></dd>
                                    </dl>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                        <h4 class="panel-title">
                            <a data-toggle="modal" data-target="#myModal2" aria-expanded="false" aria-controls="collapseThree">
                                <i class="fa fa-paper-plane" aria-hidden="true"></i> Envío de información
                            </a>
                        </h4>
                    </div>

                </div>
            </div>

        </div>

        <div class="col-lg-6 col-md-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"> <i class="fa fa-envelope-o" aria-hidden="true"></i> Mensajes</h3>
                </div>
                <div class="panel-body">

                    <div class="media">
                        <div class="media-left">
                            <i class="fa fa-exclamation-triangle media-object fa-2x text-info" aria-hidden="true"></i>
                        </div>
                        <div class="media-body">
                            <span class="alert-info"> <h4 class="media-heading">Informe 2016 y Plan de trabajo 2017</h4></span>
                            <p class="text-info">La fecha límite para el envío de tu información es el 31 de enero de 2017.</p>
                        </div>
                    </div>

                    {% if enviado is defined and enviado == 1 %}

                        <div class="media">
                            <div class="media-left">
                                <i class="fa fa-check media-object fa-2x text-success" aria-hidden="true"></i>
                            </div>
                            <div class="media-body">
                                <span class="alert-success"> <h4 class="media-heading">Hemos recibido tu información</h4></span>
                                <p class="text-success text-justify">Se ha recibido la información de tu informe y plan de trabajo, por lo tanto ya no es posible realizar modificaciones en tu informe o plan de trabajo.</p>
                            </div>
                        </div>

                    {% else %}
                        <div class="media">
                            <div class="media-left">
                                <i class="fa fa-times media-object fa-2x text-danger" aria-hidden="true"></i>
                            </div>
                            <div class="media-body">
                                <span class="alert-danger"> <h4 class="media-heading">Todavía no hemos recibido tu información</h4></span>
                                <p class="text-danger">Aún no se ha recibido información de tu informe y plan de trabajo.</p>
                            </div>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>


    <!-- Modal informe -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Vista previa</h4>
                </div>
                <div class="modal-body">
                    <div class="row page-header">
                        <div class="col-xs-6">
                            <h3>Informe 2016</h3>
                            <p> <strong>Académico:</strong> {{ academico.nombre }} {{ academico.apellido }}</p>
                        </div>
                        <div class="col-xs-6">
                            <p class="text-right"><img class="right" src="{{ asset('img/ccm.png', absolute=true) }}" width="180px" height="60px" /></p>
                        </div>
                    </div>

                    <div class="container-fluid">

                    <strong>Investigación</strong><br>
                    {% if investigaciones|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for investigacion in investigaciones %}
                                <li class="text-justify">{{ investigacion.titulo }}, <small><em> {{ investigacion.autores }}</em></small>, <small>{{ investigacion.tipo|title }}</small>,
                                        {% if investigacion.revista %} {{ investigacion.revista }},{% endif %}
                                        {% if investigacion.year %} {{ investigacion.year }}, {% endif %}
                                        {% if investigacion.volumen %}Vol. {{ investigacion.volumen }},{% endif %}
                                        {% if investigacion.pags %}{{ investigacion.pags }} págs.,{% endif %}
                                        {% if investigacion.indizado %} indizado,{% endif %}
                                        {% if investigacion.issn %} ISSN: {{ investigacion.issn  }}, {% endif %}
                                        {% if investigacion.status %} {{ investigacion.status|lower  }} {% endif %}</li>

                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Estudiantes</strong><br>
                    {% if estudiantes|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for estudiante in estudiantes %}
                                <li>{{ estudiante.alumno |title }}, <small>{{ estudiante.nivel|title }}, {{ estudiante.programa }}</small>,
                                    {{ estudiante.avance }}% de avance, {% if estudiante.titulado %} titulado el {{ estudiante.titulacion|localizeddate('long', 'none') }},{% endif %}
                                    <em> {{ estudiante.tesis }}</em>
                                    <br>
                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Posdocs</strong><br>
                    {% if posdocs|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for posdoc in posdocs %}
                                <li>{{ posdoc.nombre |title }}, <small>del {{ posdoc.inicio|localizeddate('long', 'none') }} al {{ posdoc.fin|localizeddate('long', 'none') }}</small>
                                    <br>
                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Cursos y seminarios</strong><br>
                    {% if cursos|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for curso in cursos %}
                                <li>{{ curso.nombre }}, <small>{{ curso.tipo|title }}</small>,<em> {{ curso.nivel }}, {{ curso.horas }}, {{ curso.lugar }}</em>

                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Proyectos</strong><br>
                    {% if proyectos|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for proyecto in proyectos %}
                                <li>{{ proyecto.nombre|title }}, <small>{{ proyecto.tipo }}</small>,<em> {{ proyecto.numero }}</em>

                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Eventos académicos y de divulgación</strong><br>
                    {% if eventos|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for evento in eventos %}
                                    <li class="text-justify">
                                        {{ evento.nombre }},
                                        <small>{% if evento.nacional %} nacional, {% else %} internacional,{% endif %}</small>
                                        <small>{% if evento.organizador %} organizador,{% endif %}</small>
                                        <small> {{ evento.tipo|title }},</small>
                                        {% if evento.platica %} "{{ evento.platica }}",{% endif %}
                                        <small>{% if evento.divulgacion %} Divulgación, {% endif %} </small>
                                        <em> {% if evento.institucion %} {{ evento.institucion }}</em>,{% endif %}
                                        {% if evento.actividad %} {{ evento.actividad }},{% endif %}
                                        {% if evento.pais %} {{ evento.pais }}{% endif %}
                                    </li>

                            {% endfor %}
                        </ol>
                    {% endif %}

                    <strong>Licencias y comisiones</strong><br>
                    {% if salidas|length == 0 %}
                        No se ha registrado información<br><br>
                    {% else %}
                        <ol>
                            {% for salida in salidas %}
                                <li>{{ salida.pais|title }}, <small>{{ salida.tipo|title }}</small>,<em> {{ salida.universidad }}</em>, {{ salida.actividad }},
                                    {% for proposito in salida.propositos %}
                                        {{ proposito }},
                                    {% endfor %}
                                    <br>
                                </li>
                            {% endfor %}
                        </ol>
                    {% endif %}

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal envío -->
    <div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Envío de información</h4>
                </div>

                {% if enviado is defined and enviado == 1 %}
                    <div class="panel-body">
                        <div class="col-lg-12 col-md-2 text-center">
                            <p class="text-justify alert alert-success">Hemos enviado un acuse de recibo a tu correo <em><strong>{{ app.user.email }}</strong></em></p>
                        </div>
                    </div>
                {% else %}
                    <div class="panel-body">
                        <div class="col-lg-12 col-md-2 text-center">
                            <p class="text-justify alert alert-info">Al momento de enviar tu informe y plan de trabajo recibirás un acuse de recibo a tu correo <em><strong>{{ app.user.email }}</strong></em>.<br>
                            Una vez enviada la información no será posible realizar modificaciones sobre el informe o plan de trabajo.
                            </p>
                            {% if planid is defined %}
                            <p><a class="btn btn-primary" href="{{ path('informe_send') }}" role="button"><i class="fa fa-paper-plane" aria-hidden="true"></i> Enviar informe y plan de trabajo</a></p>
                                {% else %}
                                    <p class="text-justify alert alert-danger">No has creado tu plan de trabajo.</p>
                            {% endif %}

                        </div>
                    </div>
                {% endif %}

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal envío -->
    <div class="modal fade" id="myModal3" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Vista previa</h4>
                </div>
                    <div class="panel-body">
                        {% if planid is defined %}
                            {% render controller("InformeBundle:Plan:show", {'id': planid}) %}

                        {% else %}
                            <p class="text-danger"> No se ha creado el plan de trabajo.</p>

                        {% endif %}
                    </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}